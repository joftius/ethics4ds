{
  "hash": "514c6fd9c1874dd2c97896c1b6863b7b",
  "result": {
    "markdown": "---\ntitle: \"Causal models\"\ndate: \"October 31, 2022\"\nauthor: \"Joshua Loftus\"\n---\n\n\n## Summary\n\nCausal models are useful for understanding different kinds of statistical relationships between two or more variables.\n\n## References\n\n### Assigned reading\n\n- [FairML Book](https://fairmlbook.org/causal.html) Chapter 5 on *Causality*, at least to the section on *Counterfactuals* (about halfway through).\n\n### Additional references\n\n- [FairML Book](https://fairmlbook.org/causal.html) the rest of Chapter 5.\n- [Causal Inference: The Mixtape](https://mixtape.scunning.com/index.html) Sections 1.1, 1.2, and 3.1 up to 3.1.3 (stop before 3.1.4)\n\n## Notes\n\n### Simulating data based on DAGs\n\nNote: we can make nice graphs using the [ggdag](https://cran.r-project.org/web/packages/ggdag/vignettes/intro-to-dags.html) package to plot graphs.\n\n#### Graph: $X \\rightarrow Y$\n\n**Original world**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\ntheme_set(theme_minimal())\nset.seed(1)\nn <- 200\n# Step 1: Generate variables with no parents\nf_X <- function(noise) noise - 1\nnoise_X <- rnorm(n)\nX <- f_X(noise_X)\n# Step k+1: Generate variables that had their\n# set of parents finish generating at step k\nf_Y <- function(x, noise) 3 * x + 2 * noise\nnoise_Y <- rnorm(n)\nY <- f_Y(X, noise_Y)\nqplot(X, Y)\n```\n\n::: {.cell-output-display}\n![](06-causality_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\nSample average of Y:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean(Y)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -2.812106\n```\n:::\n:::\n\n\n**World after intervention**\n\nWe start by copying and pasting the original code, then we modify the program to change some variable. In this case we do an \"atomic\" intervention setting all $X$ values to 1.\n\nSince the code is written in a way that any variables depending on $X$ (in this graph $Y$ does) are generated after $X$, this intervention on $X$ may change their distributions as well.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Step 1: Generate variables with no parents\nX <- 1\n# Step k+1: Generate variables that had their\n# set of parents finish generating at step k\nf_Y <- function(x, noise) 3 * x + 2 * noise\nnoise_Y <- rnorm(n)\nY <- f_Y(X, noise_Y)\nqplot(X, Y)\n```\n\n::: {.cell-output-display}\n![](06-causality_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nSample average of Y:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean(Y)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2.916346\n```\n:::\n:::\n\n\n**Explanation**\n\nWith this simple data generating process we can see that $X \\sim N(-1, 1)$ and $(Y | X = x) \\sim N(3x, 4)$. By linearity, $E[Y] = 3E[X] = -3$ in the original world. But after the intervention $\\text{do}(X := 1)$, we have $E[Y] = 3 E[1] = 3 \\cdot 1 = 3$. \n\n#### Graph: $X \\leftarrow U \\rightarrow Y$\n\n**Original world**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- 10000 # reduce sampling variability\n# Step 1: Generate variables with no parents\nU <- rnorm(n)\n# Step k+1: Generate variables that had their\n# set of parents finish generating at step k\nf_X <- function(u, noise) 2 * u + 3 + noise\nnoise_X <- rnorm(n)\nX <- f_X(U, noise_X)\nf_Y <- function(u, noise) u^2 + noise^2\nnoise_Y <- rnorm(n)\nY <- f_Y(U, noise_Y)\n```\n:::\n\n\nSample average of Y:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean(Y)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2.030961\n```\n:::\n:::\n\n\n**World after intervention**\n\nAn \"atomic\" intervention setting all X values to 1.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Step 1: Generate variables with no parents\nU <- rnorm(n)\n# Step k+1: Generate variables that had their\n# set of parents finish generating at step k\nX <- 1\nf_Y <- function(u, noise) u^2 + noise^2\nnoise_Y <- rnorm(n)\nY <- f_Y(U, noise_Y)\n```\n:::\n\n\nSample average of Y:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean(Y)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2.032377\n```\n:::\n:::\n\n\n**Explanation**\n\nIn this case the mean of $Y$ did not change because the variable we intervened on, $X$, is not a cause of $Y$.",
    "supporting": [
      "06-causality_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}